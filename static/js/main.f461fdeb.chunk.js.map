{"version":3,"sources":["logo.svg","utils/utils.tsx","components/AppHeader.tsx","utils/enums.tsx","components/extra/TokenInput.tsx","utils/constants.tsx","components/Modals.tsx","components/TokenPicker.tsx","components/DexDataPanel.tsx","components/AppStatusBar.tsx","components/TokenList.tsx","components/Welcome.tsx","App.tsx","reportWebVitals.ts","index.tsx","config/config.js"],"names":["formatPrice","quantity","decimals","Intl","NumberFormat","minimumFractionDigits","format","formatPriceUI","maximumSignificantDigits","formatPrice2","Img","styled","img","Header","header","Title","h1","Logo","div","PageButton","Button","JazzTitle","span","BalanceButtonBlock","BalanceBlock","ConnectButton","props","makeNewState","rpcProvider","metamask","provider","chainId","title","variant","currentAccount","diameter","seed","jsNumberForAddress","style","marginLeft","slice","pending","Spinner","animation","size","useState","buttonState","setButtonState","useEffect","width","marginRight","hidden","pageId","disabled","onClick","window","ethereum","connectMetamask","prevState","open","focus","AppHeader","hrefOptions","href","parseFloat","balance","setBalance","timer","setTimeout","Web3","eth","getBalance","then","bal","clearTimeout","appState","blockNumber","balanceString","balanceBackground","maximumFractionDigits","src","logo","alt","e","document","location","backgroundColor","ORDER_SIDE","ORDER_TYPE","Input","input","TokenInput","isEditing","state","setState","value","setValue","toggleEditing","type","name","onChange","max","target","onBlur","isNaN","length","Math","abs","onFocus","readOnly","START_BLOCK","DEX_ABI","require","abi","ModalTitle","p","TokenInfoParent","TokenInfoHorizontal","TokenInfoVertical","SideButton","TypeButton","ControlButton","TokenLabel","TokenBalance","OrderModal","defaultOrderState","side","amount","price","valid","balances","base","paired","market","buy","sell","order","setOrder","color","text","message","txState","setTxState","appstate","baseToken","pairedToken","getBalances","a","dexcontract","methods","ticker","call","baseTokenBalance","pairedTokenBalance","getMarket","buyMarket","sellMarket","getMarketPrice","prevOrder","show","disableSubmit","baseTokenSymbol","symbol","baseTokenDecimals","toString","baseTokenQuantity","pairedTokenSymbol","pairedTokenDecimals","pricePerToken","calculatedPairedTokenValue","BigInt","Modal","contentClassName","closeButton","id","as","Body","className","Object","keys","pairedTokenQuantity","Footer","Contract","_address","createOrder","send","from","txHash","catch","error","onHide","ConnectionMessageModal","handleClose","TokenErrorModal","OrderCancelModal","handleConfirmedAction","FundsModal","theme","maxValue","params","action","confirm","wallet","dex","console","spinner","setSpinner","setAmount","v","handleConfirmed","MAIN_DIV","TOKEN_DIV","BaseTokenDropdownToggle","Dropdown","Toggle","PairedTokenDropdownToggle","TradeTokensButton","TokenPicker","showConnectionMessageModal","setShowConnectionMessageModal","currentBaseTokenDisplayName","handleBaseTokenItemClick","handleBaseTokenChange","currentTarget","dataset","address","baseTokenMenuItems","tokens","map","token","Item","currentPairedTokenDisplayName","isDisabled","handlePairedTokenItemClick","handlePairedTokenChange","pairedTokenMenuItems","pairedTokenSet","pairLabelValue","pairLabelColor","Menu","tradeEnabled","showOrderModal","fontSize","fontWeight","handleShow","GrandParentContainer","ParentContainer","RowPanelBase","RowPanel","ColumnPanel","ChartDiv","Chart","OrderbookDiv","OrderbookAwaitDiv","SidesDiv","BuySideDiv","SellSideDiv","SpreadDiv","buyRowStyle","padding","sellRowStyle","headerStyle","textAlign","tableStyle","marginBottom","Orderbook","orderbook","setOrderbook","buyOrders","orderBook","sellOrders","reverse","spread","Table","striped","hover","borderless","role","OrderTab","TabButton","button","OrdersDiv","OrdersAwaitDiv","CancelOrderButton","ScrollableTable","ordersRowStyle","ordersHeaderStyle","Orders","activeOrders","setActiveOrders","completedOrders","setCompletedOrders","showCompleted","setShowCompleted","showOrderCancelModal","setShowOrderCancelModal","currentOrder","setCurrentOrder","orderHistory","activeOrderList","completedOrderList","oid","tickerFrom","orderType","tickerTo","complete","trader","filled","push","sort","b","handleConfirmedOrderCancel","useCallback","dexContract","cancelOrder","completedOrderTableView","activeOrderTableView","handleOrderCancel","buttonTitle","DexTradeInfo","FOOTER","AppStatusBar","blockNumberString","networkConfig","web3Networks","find","network","undefined","statusBarString","ERC20_ABI","Panel","ActionButton","DepositButton","WithdrawButton","MintButton","BurnButton","rowStyle","verticalAlign","TokenList","setTokens","showModal","setShowModal","modalParams","setModalParams","showErrorModal","setShowErrorModal","errorText","setErrorText","getWalletBalance","web3Client","baseTokenContract","balanceOf","getDexBalance","updateBalances","tokenListPromise","Promise","all","tokenList","handleDeposit","handleWithdrawal","handleMint","handleBurn","erc20","approve","mint","burn","rows","TextDiv","Welcome","defaultAppState","defaultMetamaskState","PageContainer","Background","App","setRpcProvider","setMetamask","setDexContract","setAppState","orderModalShow","setOrderModalShow","setOrderBook","setOrderHistory","isInitialConnect","_isInitialConnect","metamaskRpcProvider","isConnected","request","method","selectedAddress","accounts","defaultWeb3Network","on","newAccounts","newChainId","reload","componentWillMount","bRes","log","updateOrderBook","getOrderBook","prevOrderBook","err","initNetwork","url","net","getId","netId","getChainId","subscription","subscribe","result","subscriptionId","blockHeader","number","blockHeadSubscription","unsubscribe","success","initContract","dexBuildObject","networks","hasOwnProperty","initApp","getTokens","contract","getTokenList","filter","i","tokenAddress","utils","toUtf8","getBlockNumber","currentBlock","getPairedTokens","pairPromises","item","pos","arr","pairs","isValid","subscriptions","OrderCreated","OrderFilled","OrderRemoved","processPastEvents","getPastEvents","fromBlock","toBlock","evtOrderCreated","evtOrderFilled","evtOrderRemoved","orderHashTable","returnValues","reduce","obj","forEach","toBN","lt","events","event","prevOrderHistory","newOrderHistory","receipt","eventName","exact","path","to","newBaseToken","newPairedToken","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","module","exports"],"mappings":"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","file":"static/js/main.f461fdeb.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import Web3 from 'web3'\n\nexport const formatPrice = (quantity, decimals) => {\n    return new Intl.NumberFormat('en-EN', {minimumFractionDigits: 9,}).format(quantity / 10 ** decimals)\n}\n\nexport const formatPriceUI = (quantity, decimals) => {\n    return new Intl.NumberFormat('en-EN', {maximumSignificantDigits: 9, }).format(quantity / 10 ** decimals)\n}\n\nexport const formatPrice2 = (quantity) => {\n    return new Intl.NumberFormat('en-EN', {maximumSignificantDigits: 9, }).format(quantity)\n}\n\nexport const formatEthAmount = (quantity) => {\n    return new Intl.NumberFormat('en-EN', {maximumSignificantDigits: 2, maximumFractionDigits: 2}).format(quantity)\n}","import Web3 from 'web3'\n\nimport logo from '../logo.svg'\nimport styled from 'styled-components'\nimport { Button, Spinner } from 'react-bootstrap'\nimport { useEffect, useState } from 'react'\nimport { formatEthAmount } from '../utils/utils'\nimport Jazzicon, { jsNumberForAddress } from 'react-jazzicon'\n\ndeclare const window: any;\n\nconst Img = styled.img`\n  height: 4rem;\n  pointer-events: none;\n  \n  @media (prefers-reduced-motion: no-preference) {\n    animation: App-logo-spin infinite 20s linear;\n  }\n  \n  @keyframes App-logo-spin {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`\n\nconst Header = styled.header`\n  min-height: 10vh;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n`\n\nconst Title = styled.h1`\n  font-size: 2rem;\n  font-weight: bold;\n`\n\nconst Logo = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  color: white;\n  width: 280px;\n`\n\nconst PageButton = styled(Button)`\n  width: 200px;\n`\n\nconst JazzTitle = styled.span`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n`\n\nconst BalanceButtonBlock = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-radius: .25rem;\n  font-weight: bold;\n  color: #999;\n  width: 280px;\n`\nconst BalanceBlock = styled.div`\n  width: 80px;\n  display: flex:\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\n\nfunction ConnectButton(props) {\n\n  interface IConnectButtonState {\n    title: any,\n    variant: string\n    pending: boolean\n  }\n\n  /**\n   * @dev Compose new button state\n   */\n  function makeNewState() : IConnectButtonState {\n\n    if(!props.rpcProvider) {\n      return {\n        title: <Spinner animation=\"border\" variant='secondary' size='sm' />,\n        variant: 'warning',\n        pending: false\n      }\n    }\n\n    if(!props.metamask.provider) {\n      return {\n        title: 'Install Metamask',\n        variant: 'warning',\n        pending: false\n      }\n    }\n\n    let title;\n    let variant;\n    \n    // eslint-disable-next-line eqeqeq\n    if (props.metamask.provider.chainId != props.rpcProvider.chainId) {\n      // Wrong network\n      title = 'Wrong Network'\n      variant = 'danger'\n    }\n    else if (props.metamask.currentAccount) {\n      // Connected\n      title = <JazzTitle>\n        {<Jazzicon diameter={24} seed={jsNumberForAddress(props.metamask.currentAccount)} />} \n        <label style={{ marginLeft : '5px' }}>{props.metamask.currentAccount.slice(0,6) + '...' + props.metamask.currentAccount.slice(-4)}</label>\n        </JazzTitle>\n      variant = 'primary'\n    }\n    else {\n      // Connect Wallet\n      title = 'Connect Wallet'\n      variant = 'warning'\n    }\n\n    return {\n      title: title,\n      variant: variant,\n      pending: false\n    }\n  }\n\n  const [buttonState, setButtonState] = useState<IConnectButtonState>(() => {return makeNewState()})\n\n  const handleButtonClick = () => {\n    // Check if Metamask is not installed\n    if (typeof window.ethereum !== 'undefined') {\n      props.connectMetamask(true)\n      if (!props.metamask.currentAccount) {\n        setButtonState((prevState) => {\n          return {\n            ...prevState,\n            title: <Spinner animation=\"border\" variant='secondary' size='sm'/>,\n            pending: true\n          }\n        })\n      }\n    } \n    else {\n      window.open('https://metamask.io/', '_blank').focus();\n    }\n  }\n\n  useEffect(() => {\n\n    setButtonState(() => {return makeNewState()})\n  \n  },[props.rpcProvider, props.metamask.provider])\n  \n  return (\n    <Button\n      style={{ width: \"200px\", marginRight: '0px' }}\n      variant={buttonState.variant} \n      hidden={props.pageId === 0}\n      disabled={buttonState.pending}\n      onClick={handleButtonClick}>\n        {buttonState.title}\n    </Button>\n  )\n}\n\n\nexport default function AppHeader(props) {\n\n  const hrefOptions = {\n    0: {title: 'Launch App', href: '#/trade'},\n    1: {title: 'Token List', href: '#/tokens'},\n    2: {title: 'Trade Tokens', href: '#/trade'}\n  }\n\n  const handlePageButtonClick = (e, href) => {\n    document.location.href = href;\n  }\n\n  const [balance, setBalance] = useState(parseFloat(props.metamask.balance) / (10 ** 18))\n  useEffect(() => {\n\n    if (!props.metamask.provider || !props.metamask.currentAccount) {\n      return\n    }\n    \n    const timer = setTimeout(() => {\n      const web3Client = new Web3(props.metamask.provider)\n      web3Client.eth.getBalance(props.metamask.currentAccount)\n      .then(bal => {\n        setBalance(parseFloat(bal) / (10 ** 18))\n      })\n    }, 1000);\n    return () => clearTimeout(timer);\n\n  }, [props.appState.blockNumber, props.metamask.provider, props.metamask.currentAccount])\n\n  let balanceString = 'ETH: '\n  let balanceBackground = 'rgba(0,0,0,0.6)'\n  if (balance > 0 && balance < 0.1) {\n    balanceString += '<0.1'\n  } \n  else if (balance > 99) {\n    balanceString += '99+'\n  }\n  else {\n    balanceString += formatEthAmount(balance)\n  } \n  \n  if (!props.metamask.currentAccount) {\n    balanceString = ''\n    balanceBackground = 'rgba(0,0,0,0.0)'\n  }\n\n  return (\n    <Header>\n      <Logo>\n        <Img src={logo} alt=\"logo\" />\n        <Title>\n          {props.title}\n        </Title>\n      </Logo>\n      <PageButton \n        variant=\"info\" \n        onClick={(e) => handlePageButtonClick(e, hrefOptions[props.pageId].href)}>\n          {hrefOptions[props.pageId].title}\n      </PageButton>\n      <BalanceButtonBlock style={{backgroundColor: balanceBackground}}>\n        <BalanceBlock hidden={props.pageId === 0}>{balanceString}</BalanceBlock>\n        <ConnectButton pageId={props.pageId} metamask={props.metamask} rpcProvider={props.rpcProvider} connectMetamask={props.connectMetamask}/>\n      </BalanceButtonBlock>\n    </Header>\n  )\n}","export const ORDER_SIDE = {\n    0: 'Buy',\n    1: 'Sell'\n}\n\nexport const ORDER_TYPE = {\n    0: 'Market',\n    1: 'Limit',\n    2: 'IoC',\n    3: 'FoK',\n    4: 'MoC'\n}","import React from 'react'\nimport PropTypes from \"prop-types\"\nimport { useCallback, useEffect, useState } from 'react'\nimport { formatPriceUI, formatPrice2 } from '../../utils/utils'\nimport styled from 'styled-components'\n\nconst Input = styled.input`\n  text-align: end;\n  background-color: rgba(255,255,255,0.1);\n  color: #ccc;\n  border: none;\n  &:focus-visible {\n    outline: none\n  }\n`\n\nexport default function TokenInput(props) {\n\n    const [state, setState] = useState({isEditing: false})\n    const [value, setValue] = useState(props.value)\n\n    const toggleEditing = () => {\n        setState(({isEditing}) => ({isEditing: !isEditing}) )\n    }\n\n    // Update on change within the text field\n    const handleInputChange = (e) => {\n      if (props.max && parseFloat(e.target.value) > parseFloat(props.max)) {\n        setValue(() => props.max)\n        return\n      }\n      setValue(() => e.target.value)  \n    } \n\n    // Update on `props.value` change\n    useEffect(() => {\n      setValue(() => props.value)\n    }, [props.value])\n\n    return (\n        state.isEditing ? (\n          <Input\n            type=\"number\"\n            name={props.name}\n            value={value}\n            onChange={handleInputChange}\n            onBlur={() => {\n              if (isNaN(value) || value.length === 0) {\n                props.onChange(0)\n              }\n              else {\n                props.onChange(Math.abs(value))\n              }\n              toggleEditing()\n            }}\n          />\n        ) : (\n          <Input\n            type=\"text\"\n            name={props.name}\n            value={formatPrice2(value)}\n            onFocus={toggleEditing}\n            readOnly\n          />\n        )\n    )\n}\n\nTokenInput.propTypes = {\n    name: PropTypes.string,\n    value: PropTypes.string,\n    max: PropTypes.string,\n    decimals: PropTypes.string,\n    onChange: PropTypes.func\n};","export const BUY = 0\nexport const SELL = 1\n\nexport const MARKET = 0\nexport const LIMIT = 1\nexport const IOC = 2\nexport const FOK = 3\nexport const MOC = 4\n\nexport const WITHDRAW = 0\nexport const DEPOSIT = 1\nexport const MINT = 2\nexport const BURN = 3\n\nexport const START_BLOCK = 28731619","import styled from 'styled-components'\nimport { Modal, Container, Row, Col, Button, Dropdown, Form, Spinner } from 'react-bootstrap'\nimport { useCallback, useEffect, useState } from 'react'\nimport { ORDER_SIDE, ORDER_TYPE } from '../utils/enums'\nimport { formatPriceUI, formatPrice2 } from '../utils/utils'\nimport Web3 from 'web3'\nimport { Contract } from 'web3-eth-contract'\n\nimport './Modals.css'\nimport TokenInput from './extra/TokenInput'\nimport {BUY, SELL, MARKET, LIMIT, IOC, FOK, MOC } from '../utils/constants'\nimport { WITHDRAW, DEPOSIT, MINT, BURN } from '../utils/constants'\n\nconst ERC20_ABI = require('../../src/artifacts/TestToken.json').abi\nconst DEX_ABI = require('../../src/artifacts/Dex.json').abi\n\nconst ModalTitle = styled.p`\n  font-size: 1rem;\n  font-weight: bold;\n`\nconst TokenInfoParent = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\nconst TokenInfoHorizontal = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  margin-top: 5px;\n`\nconst TokenInfoVertical = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\nconst SideButton = styled(Button)`\n  width: 100%;\n  border-radius: 0px .25rem .25rem 0px;\n  margin-left: 0px;\n  &:focus {\n    box-shadow: none;\n  } \n`\nconst TypeButton = styled(Button)`\n  width: 100%;\n  border-radius: .25rem 0px 0px .25rem;\n  margin-right: 0px;\n  &:focus {\n    box-shadow: none;\n  } \n`\nconst ControlButton = styled(Button)`\n  width: 25%;\n`\nconst TokenLabel = styled.div`\n  width: 100px;\n`\nconst TokenBalance = styled.div`\n  width: 140px;\n  margin-left: 5px;\n`\n\nexport function OrderModal(props) {\n\n  const TX_NO = 0\n  const TX_PENDING = 1\n  const TX_SENT = 2\n\n  const defaultOrderState = {\n    side: BUY,\n    type: LIMIT,\n    amount: '0',\n    price: '0',\n    valid: false,\n    balances: {base:'0', paired:'0'},\n    market: {buy: '0', sell: '0'}\n  }\n\n  const [order, setOrder] = useState<any>(defaultOrderState)\n  const [message, setMessage] = useState<any>({\n    disabled: true,\n    color: '#000',\n    text: 'Dummy'\n  })\n  const [txState, setTxState] = useState<any>(TX_NO)\n\n  /**\n   * Update token balances and market prices\n   */\n  useEffect(() => {\n\n    if(!props.appstate.baseToken || !props.appstate.pairedToken || !props.metamask.currentAccount) {\n      return\n    }\n\n    const getBalances = async () => {\n      \n      const baseTokenBalance = await props.dexcontract.methods.balances(props.metamask.currentAccount, props.appstate.baseToken.ticker).call()\n      const pairedTokenBalance = await props.dexcontract.methods.balances(props.metamask.currentAccount, props.appstate.pairedToken.ticker).call()\n\n      return {base: baseTokenBalance, paired: pairedTokenBalance}\n    }\n\n    const getMarket = async () => {\n\n      let buyMarket = order.market.buy\n      let sellMarket = order.market.sell\n      try {\n        buyMarket = await props.dexcontract.methods.getMarketPrice(SELL, props.appstate.baseToken.ticker, props.appstate.pairedToken.ticker).call()\n      } catch (e) {}\n      try {\n        sellMarket = await props.dexcontract.methods.getMarketPrice(BUY, props.appstate.baseToken.ticker, props.appstate.pairedToken.ticker).call()\n      } catch (e) {}\n\n      return {buy: buyMarket, sell: sellMarket}\n    }\n\n    getBalances().then((balances) => {\n      setOrder((prevOrder) => ({...prevOrder, balances: balances}))\n    })\n    getMarket().then((market) => {\n      setOrder((prevOrder) => ({...prevOrder, market: market}))\n    }) \n\n\n  }, [props.metamask.currentAccount, props.appstate.baseToken, props.appstate.pairedToken, props.show])\n\n  useEffect(() => {\n    setOrder(() => ({...defaultOrderState, amount: '0', price: '0'}))\n  }, [props.appstate.baseToken, props.appstate.pairedToken])\n\n  // Update the price based on the current order side\n  useEffect(() => {\n    setOrder((prevOrder) => ({...prevOrder, price: prevOrder.side === SELL ? prevOrder.market.sell : prevOrder.market.buy}))\n  }, [order.side, order.market])\n\n  const disableSubmit = order.type === 0 && ((order.side === 0 && order.market.buy === '0') || (order.side === 1 && order.market.sell === '0'))\n  \n  const baseTokenSymbol = props.appstate.baseToken ? props.appstate.baseToken.symbol : ''\n  const baseTokenDecimals = props.appstate.baseToken ? props.appstate.baseToken.decimals : '1'\n  const baseTokenBalance = (order.balances.base / 10 ** baseTokenDecimals).toString()\n  const baseTokenQuantity = (order.amount / 10 ** baseTokenDecimals).toString()\n\n  const pairedTokenSymbol = props.appstate.pairedToken ? props.appstate.pairedToken.symbol : ''\n  const pairedTokenDecimals = props.appstate.pairedToken ? props.appstate.pairedToken.decimals : '1'\n  const pairedTokenBalance = (order.balances.paired / 10 ** pairedTokenDecimals).toString()\n\n  const pricePerToken = (order.price / 10 ** pairedTokenDecimals).toString()\n\n  // Calculate the total amount of paired tokens required to make a trade\n  const a = parseFloat((BigInt(order.amount) * BigInt(order.price) / BigInt(10 ** baseTokenDecimals)).toString())\n  const calculatedPairedTokenValue = (a / 10 ** pairedTokenDecimals).toString()\n\n  // Handler for order side change\n  const changeSide = () => {\n    setOrder((prevOrder) => ({...prevOrder, side: (prevOrder.side + 1) % Object.keys(ORDER_SIDE).length}))\n  }\n  // Handler for order type change\n  const changeType = () => {\n    setOrder((prevOrder) => ({...prevOrder, type: (prevOrder.type + 1) % Object.keys(ORDER_TYPE).length}))\n  }\n  // Handler for base token quantity change. Changes the `order.amount` directly\n  const changeBaseQuantity = (baseTokenQuantity) => {\n    setOrder((prevOrder) => ({\n      ...prevOrder, \n      amount: (BigInt(parseFloat(baseTokenQuantity) * 10 ** baseTokenDecimals)).toString()\n    }))\n  }\n  // Handler for base token quantity change. Changes the `order.amount` by calculating the amount base on the paired token and price\n  const changePairedQuantity = (pairedTokenQuantity) => {\n    if (order.price == 0) {\n      return\n    }\n    setOrder((prevOrder) => ({\n      ...prevOrder, \n      amount: (BigInt(parseFloat(pairedTokenQuantity) * 10 ** pairedTokenDecimals) * BigInt(10 ** baseTokenDecimals) / BigInt(order.price)).toString()\n    }))\n  }\n  // Handler for price per token change\n  const changeXchgRate = (pricePerToken) => {\n    setOrder((prevOrder) => ({\n      ...prevOrder, \n      price: (BigInt(parseFloat(pricePerToken) * 10 ** pairedTokenDecimals)).toString()\n    }))\n  }\n  // Send tx handler\n  const sendTx = () => {\n\n    setTxState(() => TX_PENDING)\n    const web3Client = new Web3(props.metamask.provider)\n    const dex = new web3Client.eth.Contract(DEX_ABI, props.dexcontract._address)\n\n    // Create order\n    dex.methods.createOrder(order.side, order.type, props.appstate.baseToken.ticker, props.appstate.pairedToken.ticker, order.price, order.amount).send({from: props.metamask.currentAccount})\n    .then((txHash) => {\n      setTxState(() => TX_NO)\n    })\n    .catch((error) => {\n      setTxState(() => TX_NO)\n    })\n  }\n\n  return (\n    <Modal {...props} aria-labelledby=\"contained-modal-title-vcenter\" contentClassName='ModalDark' animation={false}>\n      <Modal.Header closeButton>\n        <Modal.Title id=\"contained-modal-title-vcenter\" as={ModalTitle}>\n          Create Order\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body className=\"show-grid\">\n        <TokenInfoParent>\n          <TokenInfoVertical>\n            <TokenInfoHorizontal>\n              <TypeButton variant='secondary' onClick={changeType}>{ORDER_TYPE[order.type]}</TypeButton>\n              <SideButton variant={order.side === BUY ? 'info' : 'danger'} onClick={changeSide}>{ORDER_SIDE[order.side]}</SideButton>\n            </TokenInfoHorizontal>\n            <TokenInfoHorizontal>\n              <TokenLabel>{baseTokenSymbol}</TokenLabel>\n              <TokenInput \n              name='baseToken' \n              value={baseTokenQuantity}\n              decimals={baseTokenDecimals} \n              max={baseTokenBalance}\n              onChange={changeBaseQuantity}\n              />\n              <TokenBalance>{` / ${formatPrice2(baseTokenBalance)}`}</TokenBalance>\n            </TokenInfoHorizontal>\n            <TokenInfoHorizontal>\n              <TokenLabel>{pairedTokenSymbol}</TokenLabel>\n              <TokenInput \n              name='pairedToken' \n              value={calculatedPairedTokenValue}\n              decimals={pairedTokenDecimals}\n              max={pairedTokenBalance}\n              onChange={changePairedQuantity}\n              />\n              <TokenBalance>{` / ${formatPrice2(pairedTokenBalance)}`}</TokenBalance>\n            </TokenInfoHorizontal>\n            <TokenInfoHorizontal>\n              <div>Exchange Rate</div>\n            </TokenInfoHorizontal>\n            <TokenInfoHorizontal>\n              <div>{`${baseTokenSymbol} / ${pairedTokenSymbol}`}</div>\n              <TokenInput \n              name='pricePerToken'\n              value={pricePerToken}\n              decimals={pairedTokenDecimals} \n              onChange={changeXchgRate}\n              />\n            </TokenInfoHorizontal>\n          </TokenInfoVertical>\n          <TokenInfoVertical>\n          <TokenInfoHorizontal hidden={message.disabled} style={{color: message.color}}>\n              {message.text}\n            </TokenInfoHorizontal>\n          </TokenInfoVertical>\n        </TokenInfoParent>\n      </Modal.Body>\n      <Modal.Footer>\n        <ControlButton variant='warning' onClick={sendTx} disabled={disableSubmit}>{txState === TX_PENDING ? <Spinner animation=\"border\" variant='secondary' size='sm'/> : 'Submit'}</ControlButton>\n        <ControlButton variant='secondary' onClick={props.onHide}>Close</ControlButton>\n      </Modal.Footer>\n    </Modal>\n  )\n}\n\nexport function ConnectionMessageModal(props) {\n  return (\n      <Modal show={props.show} onHide={props.handleClose} size='sm' contentClassName='ModalDark'>\n        <Modal.Header closeButton>\n          <Modal.Title as={ModalTitle}>Wrong Network</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>Please connect to the correct network</Modal.Body>\n      </Modal>\n  )\n}\n\nexport function TokenErrorModal(props) {\n  return (\n      <Modal show={props.show} onHide={props.handleClose} size='sm' contentClassName='ModalDark'>\n        <Modal.Header closeButton>\n          <Modal.Title as={ModalTitle}>Error</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>{props.text}</Modal.Body>\n      </Modal>\n  )\n}\n\nexport function OrderCancelModal(props) {\n\n  const text = !props.order ? '' : `Order ${props.order.id} will be flagged as cancelled. The order will remain in the active orders until it reaches the top of the order book where it will be popped off without being executed`\n\n  return (\n      <Modal show={props.show} onHide={props.handleClose} contentClassName='ModalDark'>\n        <Modal.Header closeButton>\n          <Modal.Title as={ModalTitle}>Cancel Order</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>{text}</Modal.Body>\n        <Modal.Footer>\n          <ControlButton variant=\"secondary\" onClick={props.handleClose}>Back</ControlButton>\n          <ControlButton variant=\"primary\" onClick={props.handleConfirmedAction}>Confirm</ControlButton>\n        </Modal.Footer>\n      </Modal>\n  )\n}\n\nexport function FundsModal(props) {\n\n  let theme, maxValue\n  switch(props.params.action) {\n    case DEPOSIT:\n      theme = {title: 'Deposit Funds to Dex', variant: 'info', confirm: 'Deposit'} \n      maxValue = props.params.balance.wallet\n      break\n    case WITHDRAW:\n      theme = {title: 'Withdraw Funds from Dex', variant: 'danger', confirm: 'Withdraw'}\n      maxValue = props.params.balance.dex\n      break\n    case MINT:\n      theme = {title: 'Mint ERC20 tokens', variant: 'info', confirm: 'Mint'} \n      maxValue = '1000000'\n      break\n    case BURN:\n      theme = {title: 'Burn ERC20 Tokens', variant: 'danger', confirm: 'Burn'}\n      maxValue = props.params.balance.wallet\n      break\n    default:\n      console.error(\"Wrong action parameter\");\n  }\n  \n\n  const [spinner, setSpinner] = useState(false)\n  const [amount, setAmount] = useState('0')\n\n  return (\n      <Modal show={props.show} onHide={props.handleClose} contentClassName='ModalDark'>\n        <Modal.Header closeButton>\n          <Modal.Title as={ModalTitle}>{theme.title}</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <TokenInfoHorizontal>\n            {`Enter ${props.params.symbol} amount:`}\n          </TokenInfoHorizontal>\n          <TokenInfoHorizontal>\n            <TokenInput \n            name='amount'\n            value=''\n            max={maxValue}\n            decimals={props.params.decimals} \n            onChange={(v) => (setAmount(() => (BigInt(v) * BigInt(10 ** props.params.decimals)).toString()))}\n            />\n          </TokenInfoHorizontal>\n        </Modal.Body>\n        <Modal.Footer>\n          <ControlButton variant=\"secondary\" onClick={props.handleClose}>Back</ControlButton>\n          <ControlButton variant={theme.variant} onClick={() => {\n            setSpinner(() => true)\n            props.handleConfirmed({...props.params, amount: amount})\n            .then(() => setSpinner(false))\n            .catch(error => console.error(error))\n            props.handleClose()\n          }}>\n            {spinner ? <Spinner animation=\"border\" variant='secondary' size='sm'/>  : theme.confirm}\n          </ControlButton>\n        </Modal.Footer>\n      </Modal>\n  )\n}  ","import styled from 'styled-components'\nimport { Dropdown, Button } from 'react-bootstrap'\nimport React, {useState, useEffect, useCallback} from 'react'\nimport { ConnectionMessageModal } from './Modals'\n\nconst MAIN_DIV = styled.div`\n    display:flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: flex-start;\n`\n\nconst TOKEN_DIV = styled.div`\n    display:flex;\n    flex-direction: row;\n    align-items: flex-start;\n    justify-content: flex-start;\n`\n\nconst BaseTokenDropdownToggle = styled(Dropdown.Toggle)`\n    border-top-left-radius: .25rem;\n    border-top-right-radius: 0%;\n    border-bottom-right-radius: 0%;\n    border-bottom-left-radius: .25rem;\n    min-width: 100px;\n`\nconst PairedTokenDropdownToggle = styled(Dropdown.Toggle)`\n    border-top-left-radius: 0%;\n    border-top-right-radius: .25rem;\n    border-bottom-right-radius: .25rem;\n    border-bottom-left-radius: 0%;\n    min-width: 100px;\n`\nconst TradeTokensButton = styled(Button)`\n    border-radius: 0%; \n    margin: 10px, 0px, 10px, 0px;\n`\n\nexport default function TokenPicker(props) {\n\n    // connectMessageModal handling\n    const [showConnectionMessageModal, setShowConnectionMessageModal] = useState(false);\n  \n    \n    // Base Token\n    const currentBaseTokenDisplayName = props.appState.baseToken ? props.appState.baseToken.symbol: ''\n\n    const handleBaseTokenItemClick = (e) => {\n        props.handleBaseTokenChange( {\n            ticker: e.currentTarget.dataset.ticker, \n            symbol: e.currentTarget.dataset.symbol, \n            address: e.currentTarget.dataset.address,\n            decimals: e.currentTarget.dataset.decimals\n        })\n    }\n\n    const baseTokenMenuItems = props.appState.tokens.map((token) => {\n        return (\n            <Dropdown.Item \n            key={token.ticker} \n            onClick={handleBaseTokenItemClick} \n            data-ticker={token.ticker} \n            data-symbol={token.symbol}\n            data-address={token.address}\n            data-decimals={token.decimals}>\n                {token.symbol}\n            </Dropdown.Item>\n        )\n    })\n\n    // Paired Token\n    const currentPairedTokenDisplayName = props.appState.pairedToken ? props.appState.pairedToken.symbol: 'None'\n    const isDisabled = props.appState.pairedToken ? false: true\n\n    const handlePairedTokenItemClick = (e) => {\n        props.handlePairedTokenChange( {\n            ticker: e.currentTarget.dataset.ticker, \n            symbol: e.currentTarget.dataset.symbol, \n            address: e.currentTarget.dataset.address,\n            decimals: e.currentTarget.dataset.decimals\n        })\n    }\n\n    const pairedTokenMenuItems = props.appState.pairedTokenSet.map((token) => {\n        return (\n            <Dropdown.Item \n            key={token.ticker} \n            onClick={handlePairedTokenItemClick}\n            data-ticker={token.ticker} \n            data-symbol={token.symbol}\n            data-address={token.address}\n            data-decimals={token.decimals}>\n                {token.symbol}\n            </Dropdown.Item>\n        )\n    })\n\n    const handleTradeTokensButtonClick = (e) => {\n        props.appState.tradeEnabled ? props.showOrderModal() : setShowConnectionMessageModal(true)\n    }\n\n    // Pair label\n    const pairLabelValue = props.appState.pairedToken \n    ? props.appState.baseToken.symbol+'/'+props.appState.pairedToken.symbol\n    : 'No Trading Pair'\n    const pairLabelColor = props.appState.pairedToken ? '#4bff52' : 'grey'\n\n    return (\n        <MAIN_DIV>\n        <TOKEN_DIV>\n            <Dropdown>\n            <BaseTokenDropdownToggle variant=\"primary\">\n                {currentBaseTokenDisplayName}\n            </BaseTokenDropdownToggle>\n            <Dropdown.Menu>\n               {baseTokenMenuItems}\n            </Dropdown.Menu>\n            </Dropdown>\n\n            <TradeTokensButton \n            variant=\"primary\" \n            hidden={isDisabled}\n            onClick={handleTradeTokensButtonClick}>\n                <i className=\"fas fa-sync-alt\"></i>\n            </TradeTokensButton>{' '}\n\n            <Dropdown>\n            <PairedTokenDropdownToggle variant=\"primary\" disabled={isDisabled}>\n                {currentPairedTokenDisplayName}\n            </PairedTokenDropdownToggle>\n            <Dropdown.Menu>\n               {pairedTokenMenuItems}\n            </Dropdown.Menu>\n            </Dropdown>\n        </TOKEN_DIV>\n            <p style={{fontSize: '0.9rem', fontWeight: 'bold', color: pairLabelColor}}>{pairLabelValue}</p>\n            <ConnectionMessageModal \n                show={showConnectionMessageModal} \n                handleShow={() => setShowConnectionMessageModal(true)} \n                handleClose={() => setShowConnectionMessageModal(false)} \n            />\n        </MAIN_DIV>\n    )\n}\n","import styled from 'styled-components'\nimport { useState, useEffect, useCallback } from 'react'\nimport { Table, Spinner, Button } from 'react-bootstrap'\nimport { ORDER_SIDE, ORDER_TYPE } from '../utils/enums'\nimport { formatPrice, } from '../utils/utils'\nimport { OrderCancelModal } from './Modals'\n\n// Generic styles for the page\nconst GrandParentContainer = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n`\n\nconst ParentContainer = styled.div`\n    width: 1200px;\n    min-width: 1000px;\n`\nconst RowPanelBase = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: start;\n    margin-bottom: 10px;\n`\nconst RowPanel = styled.div`\n    background:rgba(0, 0, 0,0.6);\n    height: 37vh;\n    border-radius: 10px;\n    text-align: left;\n`\nconst ColumnPanel = styled(RowPanel)`\n    width: 50%;\n`\nconst Title = styled.p`\n    font-weight: bold;\n    color: #fff;\n    font-size: 0.85rem;\n    margin: 5px 10px;\n`\n\n// Chart panel\nconst ChartDiv = styled(ColumnPanel)`\n    margin-right: 5px;\n`\nfunction Chart(props) {\n    return (\n        <ChartDiv><Title>Chart</Title></ChartDiv>\n    )\n}\n\n// Orderbook panel\nconst OrderbookDiv = styled(ColumnPanel)`\n    margin-left: 5px;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: flex-start;\n`\nconst OrderbookAwaitDiv = styled(ColumnPanel)`\n    margin-left: 5px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n`\nconst SidesDiv = styled.div`\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: flex-start;\n    height: 100%;\n`\nconst BuySideDiv = styled.div`\n    overflow-y: scroll;\n    width: 100%;\n    display: flex;\n    flex-direction: column-reverse;\n    background-color: rgba(0,0,255,0.2);\n    height: 47%;\n`\nconst SellSideDiv = styled.div`\n    overflow-y: scroll;\n    width: 100%;\n    border-radius: 0 0 10px 10px;\n    background-color: rgba(255,0,0,0.2);\n    padding-bottom: .5rem;\n    height: 47%;\n`\nconst SpreadDiv = styled.div`\n    font-size: 0.75rem;\n    margin-bottom: 0px;\n    padding: 0 .5rem;\n    width: 100%;\n    background-color: rgba(255,0,255,0.1);\n`\nconst buyRowStyle = {\n    padding: '0 .5rem',\n    width: '50%',\n}\nconst sellRowStyle = {\n    padding: '0 .5rem',\n    width: '50%',\n}\nconst headerStyle = {\n    padding: '0 .5rem',\n    width: '50%',\n    textAlign: 'center' as const\n}\nconst tableStyle = {\n    fontSize: '0.75rem',\n    marginBottom: '0px'\n}\n\nexport interface IOrderBookDisplay {\n    buy: any[],\n    sell: any[],\n    spread: string\n}\n\nfunction Orderbook(props) {\n\n    const [orderbook, setOrderbook] = useState<IOrderBookDisplay | null>(null)\n\n    useEffect(() => {\n        //debugger\n        if (!props.appState.baseToken || !props.appState.pairedToken) {\n            //setOrderbook(() => ({buy: [], sell: [], spread: ''}))\n            setOrderbook(() => (null))\n            return\n        }\n\n        const buyOrders = props.orderBook.buy.map(({id, price, amount}) => {\n            return (\n                <tr key={id}>\n                    <td style={buyRowStyle}>{formatPrice(price, props.appState.pairedToken.decimals)}</td>\n                    <td style={buyRowStyle}>{formatPrice(amount, props.appState.baseToken.decimals)}</td>\n                </tr>\n            )\n        })\n        const sellOrders = props.orderBook.sell.map(({id, price, amount}) => {\n            return (\n                <tr key={id}>\n                    <td style={sellRowStyle}>{formatPrice(price, props.appState.pairedToken.decimals)}</td>\n                    <td style={sellRowStyle}>{formatPrice(amount, props.appState.baseToken.decimals)}</td>\n                </tr>\n            )\n        }).reverse()\n\n        const spread = props.orderBook.buy.length > 0 && props.orderBook.sell.length > 0 \n        ? Math.abs(props.orderBook.buy.slice(-1)[0].price - props.orderBook.sell.slice(-1)[0].price) : 0\n\n        setOrderbook(() => {\n            return {\n                buy: buyOrders,\n                sell: sellOrders,\n                spread: formatPrice(spread, props.appState.pairedToken.decimals)\n            }\n        })\n\n    }, [props.orderBook])\n\n    return (\n        !orderbook \n        ? \n        <OrderbookAwaitDiv>\n            <Spinner animation=\"border\" role=\"status\">\n                <span className=\"visually-hidden\">Loading...</span>\n            </Spinner>\n        </OrderbookAwaitDiv>\n        : orderbook.buy.length === 0 && orderbook.sell.length === 0\n        ?\n        <OrderbookAwaitDiv>\n            <p>No orders found</p>\n        </OrderbookAwaitDiv>    \n        :\n        <OrderbookDiv>\n            <Table striped hover style={tableStyle}>\n                <thead>\n                    <tr>\n                        <th style={headerStyle}>Price</th>\n                        <th style={headerStyle}>Quantity</th>\n                    </tr>\n                </thead>\n            </Table>\n            <SidesDiv>\n                <BuySideDiv>\n                    <Table striped borderless hover style={tableStyle}>\n                        <tbody>\n                            {orderbook.buy}\n                        </tbody>\n                    </Table>\n                </BuySideDiv>\n                <SpreadDiv>Spread of {!props.appState.pairedToken ? '' :`${props.appState.pairedToken.symbol ? props.appState.pairedToken.symbol : ''} ${orderbook.spread}`}</SpreadDiv>\n                <SellSideDiv>\n                    <Table striped borderless hover style={tableStyle}>\n                        <tbody>\n                            {orderbook.sell}\n                        </tbody>\n                    </Table>\n                </SellSideDiv>\n            </SidesDiv>\n        </OrderbookDiv>\n    )\n}\n\n// Orders panel\nconst OrderTab = styled.div`\n    display: flex;\n    flex-direction: column;\n    justify-content: start;\n`\nconst TabButton = styled.button`\n    background-color: rgba(0,0,0,0);\n    border-style: none;\n    border-radius: 10px;\n`\nconst OrdersDiv = styled(RowPanel)`\n    width: 100%;\n`\nconst OrdersAwaitDiv = styled(RowPanel)`\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    width: 100%;\n`\nconst CancelOrderButton = styled.button`\n    height: 18px;\n    width: 18px;\n    color: #fff;\n    background-color: rgba(0,0,0,0);\n    border: none;\n`\nconst ScrollableTable = styled.div`\n    width: 100%;\n    overflow-y: scroll;\n    height: 32vh;\n`\n\nconst ordersRowStyle = {\n    padding: '0 .5rem',\n    textAlign: 'center' as const\n}\nconst ordersHeaderStyle = {\n    padding: '0 .5rem',\n    textAlign: 'center' as const\n}\n\n\nfunction Orders(props) {\n\n    const [activeOrders, setActiveOrders] = useState<any[]>([])\n    const [completedOrders, setCompletedOrders] = useState<any[]>([])\n    const [showCompleted, setShowCompleted] = useState(false)\n    const [showOrderCancelModal, setShowOrderCancelModal] = useState(false)\n    const [currentOrder, setCurrentOrder] = useState<any>(null)\n\n    useEffect(() => {\n\n        if (!props.appState.baseToken || !props.appState.pairedToken || !props.orderHistory) {\n            return\n        }\n\n        const activeOrderList: any[] = []\n        const completedOrderList: any[] = []\n\n        for (let oid in props.orderHistory) {\n            const order = props.orderHistory[oid]\n            const {id, orderType, side, amount, price, tickerFrom, tickerTo, trader, filled, complete} = order\n            if (props.appState.baseToken.ticker === tickerTo && props.appState.pairedToken.ticker === tickerFrom) {\n                complete ? completedOrderList.push(order) : activeOrderList.push(order)\n            }\n        }\n\n        setActiveOrders(() => activeOrderList.sort((a,b) => (a.ticker > b.ticker ? 1 : -1)))\n        setCompletedOrders(() => completedOrderList.sort((a,b) => (a.ticker > b.ticker ? 1 : -1)))\n        \n\n    }, [props.appState.baseToken, props.appState.pairedToken, props.orderHistory])\n\n    const switchOrderType = () => {\n        setShowCompleted((prevState) => !prevState)\n    }\n\n    const handleOrderCancel = (order) => {\n        const {id, orderType, side, amount, price, tickerFrom, tickerTo, trader, filled, complete} = order\n        //console.log(`handleOrderCancel: ${id}, ${side}, ${tickerTo}, ${tickerFrom}, ${trader}`);\n        setCurrentOrder(() => order)\n        setShowOrderCancelModal(() => true)\n    }\n\n    const handleConfirmedOrderCancel = useCallback(() => {\n        const {id, orderType, side, amount, price, tickerFrom, tickerTo, trader, filled, complete} = currentOrder\n        //console.log(`handleConfirmedOrderCancel: ${id}, ${side}, ${tickerTo}, ${tickerFrom}, ${trader}`);\n        props.dexContract.methods.cancelOrder(id, side, tickerTo, tickerFrom).send({from: trader})\n        .then(() => {\n            setShowOrderCancelModal(() => false)\n        })\n        .catch(error => console.error(error))\n    }, [props.dexContract, currentOrder])   \n\n    const completedOrderTableView = completedOrders.map((order) => {\n        const {id, orderType, side, amount, price, tickerFrom, tickerTo, trader, filled, complete} = order\n        return (\n            <tr key={id}>\n                <td style={ordersRowStyle}>{id}</td>\n                <td style={ordersRowStyle}>{ORDER_TYPE[orderType]}</td>\n                <td style={ordersRowStyle}>{ORDER_SIDE[side]}</td>\n                <td style={ordersRowStyle}>\n                    {`${formatPrice(filled, props.appState.baseToken.decimals)} / ${formatPrice(amount, props.appState.baseToken.decimals)}`}\n                </td>\n                <td style={ordersRowStyle}>{`${formatPrice(price, props.appState.pairedToken.decimals)}`}</td>\n                <td style={ordersRowStyle}>{filled/amount * 100}</td>\n                <td style={ordersRowStyle}></td>\n            </tr>\n        )\n    })\n\n    const activeOrderTableView = activeOrders.map((order) => {\n        const {id, orderType, side, amount, price, tickerFrom, tickerTo, trader, filled, complete} = order\n        return (\n            <tr key={id}>\n                <td style={ordersRowStyle}>{id}</td>\n                <td style={ordersRowStyle}>{ORDER_TYPE[orderType]}</td>\n                <td style={ordersRowStyle}>{ORDER_SIDE[side]}</td>\n                <td style={ordersRowStyle}>\n                    {`${formatPrice(filled, props.appState.baseToken.decimals)} / ${formatPrice(amount, props.appState.baseToken.decimals)}`}\n                </td>\n                <td style={ordersRowStyle}>{`${formatPrice(price, props.appState.pairedToken.decimals)}`}</td>\n                <td style={ordersRowStyle}>{filled/amount * 100 < 1 && filled/amount * 100 > 0 ? '<1' : filled/amount * 100}</td>\n                <td style={ordersRowStyle}>\n                    <CancelOrderButton \n                    onClick={() => handleOrderCancel(order)}>\n                        <i className=\"fas fa-window-close\" />\n                    </CancelOrderButton>\n                </td>\n            </tr>\n        )\n    })\n\n    const buttonTitle = showCompleted ? \"Switch to Active Orders\" : \"Switch to Completed Orders\"\n\n    return (\n        !props.metamask.provider\n        ? \n        <OrdersAwaitDiv>\n            <p>Web3 provider is not connected</p>\n        </OrdersAwaitDiv>\n        : !props.metamask.currentAccount\n        ? \n        <OrdersAwaitDiv>\n            <p>Web3 account is not connected</p>\n        </OrdersAwaitDiv>\n        : !props.orderHistory \n        ? \n        <OrdersAwaitDiv>\n            <Spinner animation=\"border\" role=\"status\">\n                <span className=\"visually-hidden\">Loading...</span>\n            </Spinner>\n        </OrdersAwaitDiv>\n        : (completedOrderTableView.length === 0) && (activeOrderTableView.length === 0)\n        ?\n        <OrdersAwaitDiv>\n            <p>No order history found</p>\n        </OrdersAwaitDiv>    \n        :\n        <OrdersDiv>\n            <OrderCancelModal \n                show={showOrderCancelModal} \n                handleShow={() => setShowOrderCancelModal(true)} \n                handleClose={() => setShowOrderCancelModal(false)} \n                order={currentOrder}\n                handleConfirmedAction={handleConfirmedOrderCancel}\n            />\n            <OrderTab>\n                <TabButton onClick={switchOrderType}><Title>{buttonTitle}</Title></TabButton>\n                    <ScrollableTable>\n                        <Table striped hover style={tableStyle}>\n                        <thead>\n                            <tr>\n                                <th style={ordersHeaderStyle}>Id</th>\n                                <th style={ordersHeaderStyle}>Side</th>\n                                <th style={ordersHeaderStyle}>Type</th>\n                                <th style={ordersHeaderStyle}>{`Filled / Quantity, ${props.appState.baseToken ? props.appState.baseToken.symbol : ''}`}</th>\n                                <th style={ordersHeaderStyle}>{`Price, ${props.appState.pairedToken ? props.appState.pairedToken.symbol : ''}`}</th>\n                                <th style={ordersHeaderStyle}>Filled, %</th>\n                                <th style={ordersHeaderStyle}>Actions</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {showCompleted ? completedOrderTableView : activeOrderTableView}\n                        </tbody>\n                    </Table>\n                </ScrollableTable>\n            </OrderTab>\n        </OrdersDiv>\n    )\n}\n\nexport default function DexTradeInfo(props) {\n\n    return (\n        <GrandParentContainer>\n        <ParentContainer>\n            <RowPanelBase>\n                <Chart />\n                <Orderbook orderBook={props.orderBook} appState={props.appState}/>\n            </RowPanelBase>\n            <RowPanelBase>\n                <Orders orderHistory={props.orderHistory} appState={props.appState} dexContract={props.dexContract} metamask={props.metamask}/>\n            </RowPanelBase>\n        </ParentContainer>\n        </GrandParentContainer>\n    )\n}\n","import styled from 'styled-components'\nimport { web3Networks } from '../config/config'\n\nconst FOOTER = styled.div`\n    height: 5vh;\n    width: 100%;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: flex-end;\n    color: #ccc;\n`\n\nexport default function AppStatusBar(props) {\n\n    const blockNumberString = 'Last synched block: ' + props.appState.blockNumber\n    const networkConfig = props.rpcProvider ? web3Networks.find((network) => (network.chainId === props.rpcProvider.chainId)) : undefined\n    const statusBarString = networkConfig !== undefined ? 'Connected to: ' + networkConfig.name : 'Not connected'\n\n    return (\n        <FOOTER hidden={props.hidden}>\n            <p>{statusBarString}</p>\n            <p>{blockNumberString}</p>\n        </FOOTER>\n    )\n}\n","import styled from 'styled-components'\nimport { useState, useEffect, useCallback } from 'react'\nimport { Table, Spinner, Button } from 'react-bootstrap'\nimport { ORDER_SIDE, ORDER_TYPE } from '../utils/enums'\nimport { formatPrice2, formatPrice, formatPriceUI } from '../utils/utils'\nimport { FundsModal, TokenErrorModal } from './Modals'\nimport React from 'react'\nimport Web3 from 'web3'\nimport { WITHDRAW, DEPOSIT, MINT, BURN } from '../utils/constants'\n\n\nconst ERC20_ABI = require('../../src/artifacts/TestToken.json').abi\nconst DEX_ABI = require('../../src/artifacts/Dex.json').abi\n\n\n// Generic styles for the page\nconst GrandParentContainer = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n`\n\nconst ParentContainer = styled.div`\n    width: 1200px;\n    min-width: 1000px;\n`\nconst Panel = styled.div`\n    background:rgba(0, 0, 0,0.6);\n    height: 84.5vh;\n    border-radius: 10px;\n    text-align: left;\n    font-size: .75rem;\n    padding: 10px 0px 10px 0px;\n`\n\nconst ScrollableTable = styled.div`\n    width: 100%;\n    overflow-y: scroll;\n    height: 100%;\n`\nconst ActionButton = styled(Button)`\n    border-radius: 0;\n    background-color: rgba(0,0,0,0.0);\n    border: none;\n`\nconst DepositButton = styled(ActionButton)`\n    color: #00abff;\n`\nconst WithdrawButton = styled(ActionButton)`\n    color: #f00;\n`\nconst MintButton = styled(ActionButton)`\n    color: #00ff21;\n`\nconst BurnButton = styled(ActionButton)`\n    color: orange;\n`\n\nconst rowStyle = {\n    padding: '0 .5rem',\n    textAlign: 'center' as const,\n    verticalAlign: 'middle' as const\n}\nconst headerStyle = {\n    padding: '0 .5rem',\n    textAlign: 'center' as const\n}\nexport default function TokenList(props) {\n\n    const [tokens, setTokens] = useState<any>([])\n    const [showModal, setShowModal] = useState(false)\n    const [modalParams, setModalParams] = useState<any>({\n        symbol: 'Dummy', \n        amount: '0', \n        decimals: '1',\n        ticker: '',\n        balance: {dex: '0', wallet: '0'},\n        action: 0\n    })\n    const [showErrorModal, setShowErrorModal] = useState(false)\n    const [errorText, setErrorText] = useState('') \n\n    /**\n     * get tokens here. Kicks in on blockNumber, dexContract and metamask state changes\n     */\n     const getWalletBalance = useCallback(async (token) => {\n      \n        const web3Client = new Web3(props.metamask.provider);\n        let balance = await web3Client.eth.getBalance(props.metamask.currentAccount)\n        \n        // Get base token balance\n        if (token.address !== \"0x0000000000000000000000000000000000000000\" ) {\n          const baseTokenContract = new web3Client.eth.Contract(ERC20_ABI, token.address)\n          balance = await baseTokenContract.methods.balanceOf(props.metamask.currentAccount).call()\n        }\n        \n        return balance\n    }, [props.metamask.currentAccount, props.metamask.provider])\n\n    const getDexBalance = useCallback(async (token) => {\n        return await props.dexContract.methods.balances(props.metamask.currentAccount, token.ticker).call({from: props.metamask.currentAccount})\n    }, [props.metamask.currentAccount, props.dexContract])\n    \n    const updateBalances = useCallback(() => {\n\n        const tokenListPromise = props.appState.tokens.map(async (token) => {\n            return {\n                ...token,\n                balance: {\n                    dex: await getDexBalance(token),\n                    wallet: await getWalletBalance(token)\n                }\n            }\n        })\n\n        Promise.all(tokenListPromise)\n        .then((tokenList) => setTokens(() => tokenList))\n\n    }, [props.appState.blockNumber, props.appState.tokens, props.dexContract, props.metamask.currentAccount, props.rpcProvider, getWalletBalance, getDexBalance])\n\n    useEffect(() => {\n        \n        if (!props.dexContract || !props.metamask.currentAccount || !props.rpcProvider || !props.metamask.provider) {\n            return\n        }\n        \n        if (props.metamask.provider.chainId != props.rpcProvider.chainId) {\n            return\n        }\n        \n        updateBalances()\n\n    }, [updateBalances, getWalletBalance, getDexBalance])\n\n    const handleDeposit = async (token) => {\n        setModalParams(() => ({...token, action: DEPOSIT}))\n        setShowModal(() => true)\n    }\n    const handleWithdrawal = async (token) => {\n        setModalParams(() => ({...token, action: WITHDRAW}))\n        setShowModal(() => true)\n    }\n    const handleMint = async (token) => {\n        if (token.address === '0x0000000000000000000000000000000000000000') {\n            setErrorText(() => `Can't mint native coin ${token.symbol}. Please use official faucet`)\n            setShowErrorModal(() => true)\n            return\n        }\n        setModalParams(() => ({...token, action: MINT}))\n        setShowModal(() => true)\n    }\n    const handleBurn = async (token) => {\n        if (token.address === '0x0000000000000000000000000000000000000000') {\n            setErrorText(() => `Token ${token.symbol} can't be burned`)\n            setShowErrorModal(() => true)\n            return\n        }\n        setModalParams(() => ({...token, action: BURN}))\n        setShowModal(() => true)\n    }\n    const handleConfirmed = async (params) => {\n        \n        const web3Client = new Web3(props.metamask.provider)\n        const dex = new web3Client.eth.Contract(DEX_ABI, props.dexContract._address)\n        const erc20 = new web3Client.eth.Contract(ERC20_ABI, params.address)\n        \n        if (params.address === \"0x0000000000000000000000000000000000000000\") {\n            switch (params.action) {\n                case DEPOSIT:\n                    await dex.methods['deposit()']().send({from: props.metamask.currentAccount, value: params.amount })\n                    break\n                case WITHDRAW:\n                    await dex.methods['withdraw(uint256)'](params.amount).send({from: props.metamask.currentAccount })\n                    break\n                case MINT:\n                    break\n                case BURN:\n                    break\n                default:\n                    console.error(\"Wrong action paramter\")\n            } \n        }\n        else {\n            switch (params.action) {\n                case DEPOSIT:\n                    await erc20.methods.approve(props.dexContract._address, params.amount).send({from: props.metamask.currentAccount})\n                    await dex.methods['deposit(uint256,bytes32)'](params.amount, params.ticker).send({from: props.metamask.currentAccount})\n                    break\n                case WITHDRAW:\n                    await dex.methods['withdraw(uint256,bytes32)'](params.amount, params.ticker).send({from: props.metamask.currentAccount})\n                    break\n                case MINT:\n                    try {\n                        await erc20.methods.mint(props.metamask.currentAccount, params.amount).send({from: props.metamask.currentAccount})\n                    } catch (e) {\n                        setErrorText(() => `Token ${params.symbol} can't be minted. Use official ${params.symbol} faucet`)\n                        setShowErrorModal(() => true)\n                    }\n                    break\n                case BURN:\n                    try {\n                        await erc20.methods.burn(props.metamask.currentAccount, params.amount).send({from: props.metamask.currentAccount})\n                    } catch (e) {\n                        setErrorText(() => `Token ${params.symbol} can't be burned`)\n                        setShowErrorModal(() => true)\n                    }\n                    break\n                default:\n                    console.error(\"Wrong action paramter\")\n            }\n        }\n        updateBalances()\n    }\n\n    const rows = tokens.map((token) => {\n        const {symbol, ticker, address, decimals, balance} = token\n        return (<tr key={ticker}>\n            <td style={rowStyle}>{symbol}</td>\n            <td style={rowStyle}>{address}</td>\n            <td style={rowStyle}>{formatPriceUI(balance.dex, decimals)}</td>\n            <td style={rowStyle}>{formatPriceUI(balance.wallet, decimals)}</td>\n            <td style={rowStyle}>{decimals}</td>\n            <td style={rowStyle}>\n                <DepositButton variant='primary' onClick={() => handleDeposit(token)}><i className=\"fas fa-arrow-left\"/></DepositButton>\n                <WithdrawButton variant='primary' onClick={() => handleWithdrawal(token)}><i className=\"fas fa-arrow-right\"/></WithdrawButton>\n                <MintButton variant='primary' onClick={() => handleMint(token)}><i className=\"fas fa-coins\"/></MintButton>\n                <BurnButton variant='primary' onClick={() => handleBurn(token)}><i className=\"fas fa-burn\"/></BurnButton>\n            </td>\n        </tr>\n    )})\n\n    return (\n        <GrandParentContainer>\n        <ParentContainer>\n            <Panel>\n                <FundsModal \n                    show={showModal} \n                    handleShow={() => setShowModal(true)} \n                    handleClose={() => setShowModal(false)} \n                    params={modalParams}\n                    handleConfirmed={handleConfirmed}\n                />\n                <TokenErrorModal \n                    show={showErrorModal} \n                    handleShow={() => setShowErrorModal(true)} \n                    handleClose={() => setShowErrorModal(false)} \n                    text={errorText}\n                />\n                <ScrollableTable>\n                    <Table striped hover borderless>\n                    <thead>\n                        <tr>\n                            <th style={headerStyle}>Symbol</th>\n                            <th style={headerStyle}>Address</th>\n                            <th style={headerStyle}>Dex Balance</th>\n                            <th style={headerStyle}>Wallet Balance</th>\n                            <th style={headerStyle}>Decimals</th>\n                            <th style={headerStyle}>Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {rows}\n                    </tbody>\n                </Table>\n                    </ScrollableTable>\n            </Panel>\n        </ParentContainer>\n        </GrandParentContainer>\n    )\n}\n","import styled from 'styled-components'\nimport React from 'react'\n\n// Generic styles for the page\nconst GrandParentContainer = styled.div`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n`\n\nconst ParentContainer = styled.div`\n    width: 1200px;\n    min-width: 1000px;\n`\nconst TextDiv = styled.div`\n    background:rgba(0, 0, 0,0.0);\n    height: 84.5vh;\n    border-radius: 10px;\n    text-align: left;\n    font-size: 1.25rem;\n    padding: 10px 0px 10px 0px;\n\n`\n\nexport default function Welcome() {\n    return (\n        <GrandParentContainer>\n        <ParentContainer>\n        <TextDiv>\n        <p>\n            Decentralized ERC20 token exchange\n        </p>\n        <p>\n            Fun project implemented with Solidity and ReactJS\n        </p>\n        <p>\n            Author: Sergey Gorbov\n        </p>\n        <p>\n            Github: https://github.com/sedoy107/dexapp\n        </p>\n        <p>\n            This project is experimental and MUST NOT ever be deployed on the Ethereum mainnet\n        </p>\n\n        </TextDiv>\n        </ParentContainer>\n        </GrandParentContainer>\n    )\n}\n","// React tools\nimport React, {useState, useEffect, useCallback} from 'react'\nimport {HashRouter as Router, Route, Redirect} from 'react-router-dom'\n// Styling libraries\nimport styled from 'styled-components'\nimport 'bootswatch/dist/darkly/bootstrap.min.css'\nimport '@fortawesome/fontawesome-free/js/all'\n// App components\nimport AppHeader from './components/AppHeader'\nimport TokenPicker from './components/TokenPicker'\nimport DexDataPanel from './components/DexDataPanel'\nimport AppStatusBar from './components/AppStatusBar'\nimport TokenList from './components/TokenList'\nimport Welcome from './components/Welcome'\nimport { OrderModal } from './components/Modals'\n// Config\nimport { defaultWeb3Network } from './config/config'\n// Web3 imports\nimport Web3 from 'web3'\nimport { Subscription } from 'web3-core-subscriptions'\nimport { BlockHeader } from 'web3-eth'\nimport { Contract } from 'web3-eth-contract'\n// Constants\nimport { START_BLOCK } from './utils/constants'\n\nconst ERC20_ABI = require('../src/artifacts/ERC20.json').abi\n\ndeclare const window: any;\n\n// Default app state\nexport interface IToken {\n  address: string,\n  ticker: string,\n  symbol: string,\n  decimals: number\n}\nexport interface IAppState {\n  tokens: IToken[],\n  pairedTokenSet: IToken[],\n  blockNumber: number,\n  baseToken: IToken | any,\n  pairedToken: IToken | any,\n  tradeEnabled: boolean\n}\nconst defaultAppState = {\n  tokens: [],\n  pairedTokenSet: [],\n  blockNumber: 0,\n  baseToken: null,\n  pairedToken: null,\n  tradeEnabled: false\n}\n\nexport interface IMetamask {\n  provider: object | null,\n  chainId: number | null,\n  currentAccount: string | null,\n  balance: string\n}\n\nconst defaultMetamaskState = {\n  provider: null,\n  chainId: null,\n  currentAccount: null,\n  balance: '0'\n}\n\n// IRpcProvider\nexport interface IRpcProvider {\n  provider: Web3,\n  netId: number,\n  chainId: number,\n  blockHeadSubscription: Subscription<BlockHeader>,\n}\n\n// IPage\nexport interface IPage {\n  id: number,\n  title: string\n}\n\n// IOrderbookItem\nexport interface IOrderBookItem {\n  id: number,\n  price: number,\n  amount: number\n}\n\n// IOrderbook\nexport interface IOrderBook {\n  buy: IOrderBookItem[],\n  sell: IOrderBookItem[]\n}\n\n// Styles\nconst PageContainer = styled.div`\n  margin: 0px 10px 0px 10px;\n`\n\nconst Background = styled.div`\n  text-align: center;\n  height: 100vh;\n  background-image:radial-gradient(circle at top,\n  #004b77 0%, #222 100%);\n`\n\nfunction App() {\n  // States\n  const [rpcProvider, setRpcProvider] = useState<IRpcProvider | null>(null)\n  const [metamask, setMetamask] = useState<IMetamask>(defaultMetamaskState)\n  const [dexContract, setDexContract] = useState<Contract | null>(null)\n  const [appState, setAppState] = useState<IAppState>(defaultAppState)\n  const [orderModalShow, setOrderModalShow] = useState(false)\n  const [orderBook, setOrderBook] = useState<IOrderBook>({buy: [], sell: []})\n  const [orderHistory, setOrderHistory] = useState<any>(null)\n\n  const connectMetamask = useCallback( async (isInitialConnect: boolean) => {\n\n    const ethereum = window.ethereum\n\n    // Check if Metamask is not installed\n    if (typeof ethereum === 'undefined') {\n      setMetamask(() => (defaultMetamaskState))\n      return false\n    }\n    \n    const makeNewState = async (_isInitialConnect : boolean) => {\n      \n      // Initialize metamask rpc provider\n      const metamaskRpcProvider = new Web3(ethereum)\n      const chainId = _isInitialConnect || !ethereum.isConnected() ? await ethereum.request({ method: 'eth_chainId' }) : ethereum.chainId\n      const accounts = _isInitialConnect || !ethereum.isConnected() ? await ethereum.request({ method: 'eth_requestAccounts' }) : [ethereum.selectedAddress]\n      const currentAccount = accounts.length === 0 ? null : accounts[0]\n      const balance = currentAccount === null ? '0' : await metamaskRpcProvider.eth.getBalance(currentAccount)\n      setMetamask(() : IMetamask => {\n        return {\n          provider: ethereum,\n          chainId: chainId,\n          currentAccount: currentAccount,\n          balance: balance\n        }\n      })\n      setAppState((prevState) => {\n        return {\n          ...prevState,\n          // eslint-disable-next-line eqeqeq\n          tradeEnabled: chainId == defaultWeb3Network.chainId && currentAccount !== null\n        }\n      })\n    }\n\n    // Note that this event is emitted on page load.\n    // If the array of accounts is non-empty, you're already\n    // connected.\n    ethereum.on('accountsChanged', (newAccounts: string[]) => {\n      makeNewState(false)\n    });\n\n    // Subscribe for events only when the application loads for the first time\n    ethereum.on('chainChanged', (newChainId: number) => {\n      //makeNewState(false)\n      window.location.reload()\n    })\n\n    makeNewState(isInitialConnect)\n\n    return true\n  }, [])\n\n  /**\n   * @dev Initialize Metamask on page load\n   * \n   * Side effect depends on: window.ethereum\n   *  \n   * Cleanup: ?\n   * */ \n  useEffect(() => {\n    /**\n     * @dev React component lifecycle alias\n     * */\n    const componentWillMount = async () => {\n    const bRes = await connectMetamask(false)\n    console.log(bRes ? '[connectMetamask] - Success' : '[connectMetamask]: failure');\n    }\n\n    /**\n     * @dev Call the lifecycle function\n     * */\n    componentWillMount()\n  }, [connectMetamask])\n\n  const updateOrderBook = useCallback(() => {\n\n    if(!appState.pairedToken || !dexContract) {\n      setOrderBook(() => ({buy: [], sell: []}))\n      return\n    }\n\n    const BUY = 0\n    const SELL = 1\n\n    dexContract.methods.getOrderBook(BUY, appState.baseToken.ticker, appState.pairedToken.ticker).call()\n    .then(orderbook => {\n      setOrderBook((prevOrderBook) => {\n        console.log(\"Update BUY orderbook\");\n        return {\n          ...prevOrderBook,\n          buy: orderbook.map(({id, price, amount, filled}) => ({id: id, price: price, amount: amount - filled}))\n        }\n      })\n    })\n    .catch(err => {\n        console.error(err);\n    })\n\n    dexContract.methods.getOrderBook(SELL, appState.baseToken.ticker, appState.pairedToken.ticker).call()\n    .then(orderbook => {\n      setOrderBook((prevOrderBook) => {\n        console.log(\"Update SELL orderbook\");\n        return {\n          ...prevOrderBook,\n          sell: orderbook.map(({id, price, amount, filled}) => ({id: id, price: price, amount: amount - filled}))\n        }\n      })\n    })\n    .catch(err => {\n        console.error(err);\n    })\n\n  }, [dexContract, appState.pairedToken])\n\n  const updateChartData = () => {\n\n    if(!appState.baseToken) {\n      return\n    }\n\n    console.log(\"Placeholder for fetching chart data\");\n\n  }\n\n  /**\n   * @dev Initialize Network\n   * \n   * Side effect depends on: none (should run only once)\n   *  \n   * Cleanup: remove the subscription for network events\n   * */ \n  useEffect(() => {\n\n    /**\n     * - Initialize network\n     * - Subscribe for network events\n     * - Set rpcProvider state\n     */\n    const initNetwork = async () => {\n      // Connect to the primary network via WebSocket RPC provider\n      const rpcProvider = new Web3(defaultWeb3Network.url)\n      const netId = await rpcProvider.eth.net.getId()\n      const chainId = netId === defaultWeb3Network.netId ? defaultWeb3Network.chainId : await rpcProvider.eth.getChainId()\n\n      // Subscribe for newBlockHeaders events to track block updates\n      const subscription = rpcProvider.eth.subscribe('newBlockHeaders', (error, result) => {\n        if (!error) {\n          console.log(\"Subscribed: \" + result);\n          return;\n        }\n        console.error(error);\n      })\n      .on(\"connected\", function(subscriptionId){\n          console.log(subscriptionId);\n      })\n      .on(\"data\", function(blockHeader){\n          setAppState((prevState) => ({...prevState, blockNumber: blockHeader.number}))\n      })\n      .on(\"error\", console.error);\n  \n      setRpcProvider((prevState) => ({\n        provider: rpcProvider, \n        netId: netId,\n        chainId: chainId,\n        blockHeadSubscription: subscription,\n      }))\n\n      return true\n    }\n\n    /**\n     * @dev React component lifecycle alias\n     * */\n    const componentWillMount = async () => {\n      const bRes = await initNetwork()\n      console.log(bRes ? '[initNetwork] - Success' : '[initNetwork]: failure');\n    }\n\n    /**\n     * @dev Call the lifecycle function\n     * */\n    componentWillMount()\n\n    // useEffect cleanup:\n    return () => {\n      if(rpcProvider) {\n        rpcProvider.blockHeadSubscription.unsubscribe(function(error, success){\n          if (success) {\n              console.log('Successfully unsubscribed!');\n          }\n        })\n      }\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  /**\n   * @dev Initialize Smart Contract\n   * \n   * Side effect depends on: rpcProvider state\n   *  \n   * Cleanup: remove the subscription for contract events\n   * */ \n  useEffect(() => {\n\n    /**\n     * - Initialize smart contract\n     * - Subscribe for smart contract events\n     * - Set dexContract state\n     */\n    const initContract = async () => {\n      // Do nothing if the rpcProvider is not initialized\n      if (!rpcProvider) {\n        return false\n      }\n\n      // Read contract build JSON\n      const dexBuildObject = require('./artifacts/Dex.json')\n      \n      // Check if the contract was deployed to the given network\n      if (!dexBuildObject.networks.hasOwnProperty(rpcProvider.netId)) {\n        console.error('Contract hasn\\'t been deployed on the given network')\n        return false\n      }\n\n      // Initialize Dex contract from address and abi\n      const address = dexBuildObject.networks[rpcProvider.netId].address\n      const abi = dexBuildObject.abi;\n      const dexContract = new rpcProvider.provider.eth.Contract(abi, address)\n      \n      setDexContract(() => dexContract)\n\n      return true\n    }\n\n    /**\n     * @dev React component lifecycle alias\n     * */\n    const componentWillMount = async () => {\n      const bRes = await initContract()\n      console.log(bRes ? '[initContract] - Success' : '[initContract]: failure');\n    }\n\n    /**\n     * @dev Call the lifecycle function\n     * */\n    componentWillMount()\n\n    // useEffect cleanup:\n    // return the cleanup here\n\n  }, [rpcProvider])\n\n  /**\n   * @dev Initialize App State\n   * \n   * Side effect depends on: dexContract state\n   *  \n   * Cleanup: n/a\n   * */ \n  useEffect (() => {\n    /**\n     * - Initialize smart contract\n     * - Subscribe for smart contract events\n     * - Set dexContract and appState states\n     */\n    const initApp = async () => {\n      \n      // Aux function to get tokens from the contract \n      const getTokens = async (contract: Contract) => {\n        //debugger\n        const tokens = await contract.methods.getTokenList().call()\n        //debugger\n        return [...tokens]\n          .sort((a,b) => (a.ticker > b.ticker ? 1 : -1))\n          .filter((i,p,a) => {return !p || i.ticker !== a[p - 1].ticker})\n          .map((token) => ({address: token.tokenAddress, ticker: token.ticker, decimals: token.decimals, symbol:Web3.utils.toUtf8(token.ticker)}))\n      }\n      \n      // Check if any of the required states aren't ready yet\n      if (!dexContract || !rpcProvider) {\n        return false\n      }\n      \n      // Get current block number\n      const currentBlock = await rpcProvider.provider.eth.getBlockNumber()\n\n      // Get token list from the contract\n      const tokens = await getTokens(dexContract)\n\n      setAppState((prevState) => ({\n        ...prevState,\n        blockNumber: currentBlock,\n        tokens: tokens,\n        baseToken: tokens[0]\n      }))\n\n      return true\n    }\n\n    /**\n     * @dev React component lifecycle alias\n     * */\n    const componentWillMount = async () => {\n      const bRes = await initApp()\n      console.log(bRes ? '[initApp] - Success' : '[initApp]: failure');\n    }\n\n    /**\n     * @dev Call the lifecycle function\n     * */\n    componentWillMount()\n\n    // useEffect cleanup:\n    // return the cleanup callback\n\n  }, [dexContract, rpcProvider])\n\n  /**\n   * @dev Update Dex on baseToken change\n   * \n   * Side effect depends on: baseToken\n   *  \n   * Cleanup: n/a\n   * */ \n   useEffect (() => {\n\n    const getPairedTokens = async () => {\n\n      if (!appState.baseToken || !dexContract) {\n          return false\n      }\n\n      const pairPromises = appState.tokens\n      .filter((item,pos,arr) => (item.ticker !== appState.baseToken.ticker))\n      .map(async (token) => {\n          \n          return ({\n              ...token,\n              isValid: await dexContract.methods.pairs(appState.baseToken.ticker, token.ticker).call()\n          })\n      })\n      await Promise.all(pairPromises)\n      .then((pairs) => {\n          \n        const pairedTokenSet = pairs.filter((item,pos,arr) => (item.isValid === true))\n        .map((token) : IToken => ({address: token.address, ticker: token.ticker, symbol: token.symbol, decimals: token.decimals}))\n\n        const pairedToken = pairedTokenSet.length > 0 ? pairedTokenSet[0] : null\n        setAppState((prevState) : IAppState => {\n          return {\n            ...prevState,\n            pairedTokenSet: pairedTokenSet,\n            pairedToken: pairedToken\n          }\n        })\n      })\n      \n      return true\n  }\n    \n    /**\n     * @dev React component lifecycle alias\n     * */\n    const componentWillMount = async () => {\n      const bRes = await getPairedTokens()\n      console.log(bRes ? '[getPairedTokens] - Success' : '[getPairedTokens]: failure');\n    }\n\n    /**\n     * @dev Call the lifecycle function\n     * */\n    componentWillMount()\n\n    //useEffect cleanup:\n    // return the cleanup callback\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [appState.baseToken])\n\n  /**\n   * @dev Update Dex on when pairedToken changes\n   * \n   * Side effect depends on: updateOrderBook and updateChartData callbacks\n   *  \n   * Cleanup: n/a\n   * */ \n  useEffect (() => {\n\n    /**\n     * @dev React component lifecycle alias\n     * */\n    const componentWillMount = async () => {\n      updateOrderBook()\n      updateChartData()\n    }\n\n    /**\n     * @dev Call the lifecycle function\n     * */\n     componentWillMount()\n\n     //useEffect cleanup:\n     //return clean up callback\n\n  }, [dexContract, appState.pairedToken, appState.baseToken, appState.blockNumber])\n\n  /**\n   * @dev Update Dex on pairedToken and currentAccount change\n   * \n   * Side effect depends on: pairedToken and currentAccount\n   *  \n   * Cleanup: unsubscribe from DEX events for the particular account\n   * */ \n  useEffect (() => {\n\n    if(!dexContract || !metamask.currentAccount) {\n      return\n    }\n\n    const subscriptions = {\n      OrderCreated: null,\n      OrderFilled: null,\n      OrderRemoved: null\n    }\n    \n    const unsubscribe = () => {\n      for (let eventName in subscriptions) {\n        if (subscriptions[eventName]) {\n          subscriptions[eventName].unsubscribe()\n          console.log(`Unsubscribed from DEX ${eventName} events for trader ${metamask.currentAccount}`);\n        }\n      }\n    }\n\n    const subscribe = () => {\n      subscriptions.OrderCreated = dexContract.events.OrderCreated({\n        filter: {trader: metamask.currentAccount ? metamask.currentAccount : ''},\n        fromBlock: \"latest\"\n      }, function(error, event){ console.log(event); })\n      .on(\"connected\", function(subscriptionId){\n          console.log(`Subscribed for OrderCreated events for ${metamask.currentAccount}. SubscriptionId: ${subscriptionId}`);\n      })\n      .on('data', ({returnValues}) => {\n        setOrderHistory((prevOrderHistory) => {\n          const newOrderHistory = {...prevOrderHistory} \n          const {id, orderType, side, amount, price, tickerFrom, tickerTo, trader} = returnValues\n          newOrderHistory[id] = {\n            id:id,\n            orderType:orderType,\n            side:side,\n            amount:amount,\n            price:price,\n            tickerFrom:tickerFrom,\n            tickerTo:tickerTo,\n            trader:trader,\n            filled:0,\n            complete:false\n          }\n          \n          return newOrderHistory\n        })\n      })\n      .on('changed', (event) => {\n          // remove event from local database\n      })\n      .on('error', (error, receipt) => { // If the transaction was rejected by the network with a receipt, the second parameter will be the receipt.\n          console.error(error)\n      })\n\n      subscriptions.OrderFilled = dexContract.events.OrderFilled({\n        filter: {trader: metamask.currentAccount ? metamask.currentAccount : ''},\n        fromBlock: \"latest\"\n      }, function(error, event){ console.log(event); })\n      .on(\"connected\", function(subscriptionId){\n          console.log(`Subscribed for OrderFilled events for ${metamask.currentAccount}. SubscriptionId: ${subscriptionId}`);\n      })\n      .on('data', ({returnValues}) => {\n        setOrderHistory((prevOrderHistory) => {\n          const newOrderHistory = {...prevOrderHistory} \n          const {id, trader, price, filled} = returnValues\n          newOrderHistory[id].filled = Web3.utils.toBN(newOrderHistory[id].filled).lt(Web3.utils.toBN(filled)) ? filled : newOrderHistory[id].filled\n          return newOrderHistory\n        })\n    })\n      .on('changed', (event) => {\n          // remove event from local database\n      })\n      .on('error', (error, receipt) => { // If the transaction was rejected by the network with a receipt, the second parameter will be the receipt.\n          console.error(error)\n      })\n\n      subscriptions.OrderRemoved = dexContract.events.OrderRemoved({\n        filter: {trader: metamask.currentAccount ? metamask.currentAccount : ''},\n        fromBlock: \"latest\"\n      }, function(error, event){ console.log(event); })\n      .on(\"connected\", function(subscriptionId){\n          console.log(`Subscribed for OrderFilled events for ${metamask.currentAccount}. SubscriptionId: ${subscriptionId}`);\n      })\n      .on('data', ({returnValues}) => {\n          setOrderHistory((prevOrderHistory) => {\n            const newOrderHistory = {...prevOrderHistory} \n            const {id, trader, filled} = returnValues\n            newOrderHistory[id].complete = true\n            return newOrderHistory\n          })\n\n          /**\n           * TODO: withdraw funds to the wallet owned by `metamask.currentAccount`\n           * \n           * Buy order: withdraw the amount filled\n           * Sell order: withdraw the amount filled * price / pairedToken.decimals\n           * \n           * \n           */\n      })\n      .on('changed', (event) => {\n          // remove event from local database\n      })\n      .on('error', (error, receipt) => { // If the transaction was rejected by the network with a receipt, the second parameter will be the receipt.\n          console.error(error)\n      })\n    }\n\n    const processPastEvents = async () => {\n      \n      const evtOrderCreated = await dexContract.getPastEvents('OrderCreated', {\n        filter: {trader: metamask.currentAccount ? metamask.currentAccount : ''},\n        fromBlock: START_BLOCK,\n        toBlock: 'latest'\n      })\n\n      const evtOrderFilled = await dexContract.getPastEvents('OrderFilled', {\n        filter: {trader: metamask.currentAccount ? metamask.currentAccount : ''},\n        fromBlock: START_BLOCK,\n        toBlock: 'latest'\n      })\n\n      const evtOrderRemoved = await dexContract.getPastEvents('OrderRemoved', {\n        filter: {trader: metamask.currentAccount ? metamask.currentAccount : ''},\n        fromBlock: START_BLOCK,\n        toBlock: 'latest'\n      })\n\n      let orderHashTable = evtOrderCreated\n      .map(({returnValues}) => returnValues)\n      .reduce((obj, item) =>  (obj[item['id']] = {\n        id: item.id, \n        orderType: item.orderType, \n        side: item.side, \n        amount: item.amount, \n        price: item.price, \n        tickerFrom: item.tickerFrom, \n        tickerTo: item.tickerTo, \n        trader: item.trader,\n        filled: 0,\n        complete: false\n      }, obj), {})\n      \n      evtOrderFilled.forEach(({returnValues}) => {\n        const {id, trader, price, filled} = returnValues\n        orderHashTable[id].filled = Web3.utils.toBN(orderHashTable[id].filled).lt(Web3.utils.toBN(filled)) ? filled : orderHashTable[id].filled\n      })\n\n      evtOrderRemoved.forEach(({returnValues}) => {\n        const {id, trader, filled} = returnValues\n        orderHashTable[id].complete = true\n      })\n\n      setOrderHistory(() => orderHashTable)\n    }\n\n    /**\n     * @dev React component lifecycle alias\n     * */\n    const componentWillMount = async () => {\n      \n      processPastEvents()\n      subscribe()\n    }\n\n    /**\n     * @dev Call the lifecycle function\n     * */\n     componentWillMount()\n\n     //useEffect cleanup:\n     return unsubscribe\n\n  }, [metamask.currentAccount, dexContract])\n\n\n  const handleBaseTokenChange = (newBaseToken) => {\n    setAppState((prevState) => {\n      return {\n        ...prevState,\n        baseToken: newBaseToken\n      }\n    })\n  }\n\n  const handlePairedTokenChange = (newPairedToken) => {\n    setAppState((prevState) => {\n      return {\n        ...prevState,\n        pairedToken: newPairedToken\n      }\n    })\n  }\n\n  // React Render\n  return (\n    <Router>\n      <Route exact path=\"/\">\n        <Redirect to=\"/welcome\" />\n      </Route>\n      <Route exact path='/welcome'>\n        <Background>\n          <PageContainer>\n            <AppHeader title='DEX' appState={appState} pageId={0} rpcProvider={rpcProvider} metamask={metamask} connectMetamask={connectMetamask}/>\n            <Welcome />\n            <AppStatusBar rpcProvider={rpcProvider} appState={appState} hidden={true}/>\n          </PageContainer>\n        </Background>\n      </Route>\n      <Route exact path='/trade'>\n        <Background>\n          <PageContainer>\n            <AppHeader title='DEX' appState={appState} pageId={1} rpcProvider={rpcProvider} metamask={metamask} connectMetamask={connectMetamask}/>\n            <TokenPicker \n              appState={appState} \n              dexContract={dexContract} \n              handleBaseTokenChange={handleBaseTokenChange}\n              handlePairedTokenChange={handlePairedTokenChange}\n              showOrderModal={() => setOrderModalShow(true)}\n            />\n            <OrderModal \n              show={orderModalShow} \n              onHide={() => setOrderModalShow(false)} \n              metamask={metamask} \n              appstate={appState}\n              dexcontract={dexContract}\n            />\n            <DexDataPanel orderBook={orderBook} orderHistory={orderHistory} appState={appState} dexContract={dexContract} metamask={metamask}/>\n            <AppStatusBar rpcProvider={rpcProvider} appState={appState} hidden={false}/>\n          </PageContainer>\n        </Background>\n      </Route>\n      <Route exact path='/tokens'>\n        <Background>\n          <PageContainer>\n            <AppHeader title='DEX' appState={appState} pageId={2} rpcProvider={rpcProvider} metamask={metamask} connectMetamask={connectMetamask}/>\n              <TokenList appState={appState} rpcProvider={rpcProvider} metamask={metamask} dexContract={dexContract}/>\n            <AppStatusBar rpcProvider={rpcProvider} appState={appState} hidden={false}/>\n          </PageContainer>\n        </Background>\n      </Route>\n    </Router>\n  )\n}\n\nexport default App;\n\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// Web3config.json\nconst web3Networks = [\n    {\n      netId:5777,\n      chainId: 0x539,\n      url: 'ws://127.0.0.1:7545',\n      name: 'Local Ganache Chain'\n    },\n    {\n      netId:5777,\n      chainId: 0x1691,\n      url: 'ws://127.0.0.1:8545',\n      name: 'Ganache Cli Chain'\n    },\n    {\n      netId:0x2a,\n      chainId: 0x2a,\n      url: 'wss://kovan.infura.io/ws/v3/ef7d535d2fae48ab9e620c46dbd8788a',\n      name: 'Kovan Testnet'\n    }\n  ]\n  \nconst defaultWeb3Network = web3Networks[2]\n\nmodule.exports = {\n  web3Networks,\n  defaultWeb3Network,\n}"],"sourceRoot":""}